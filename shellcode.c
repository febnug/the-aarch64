#include <stdio.h>
#include <string.h>
#include <unistd.h>

unsigned char shellcode[] = {
    0xd2, 0x80, 0x00, 0x01,   // mov x0, #1
    0x10, 0x00, 0x00, 0x58,   // adr x1, msg
    0xe2, 0x03, 0x00, 0x32,   // mov x2, #7
    0x88, 0x00, 0x80, 0xd2,   // mov x8, #64
    0x01, 0x00, 0x00, 0xd4,   // svc #0
    0x00, 0x00, 0x80, 0xd2,   // mov x0, #0
    0x5d, 0x01, 0x80, 0xd2,   // mov x8, #93
    0x01, 0x00, 0x00, 0xd4,   // svc #0
    0x74, 0x68, 0x6f, 0x72,   // "thor"
    0x69, 0x71, 0x0a         // "iq\n"
};

int main() {
    // Menjalankan shellcode sebagai fungsi
    printf("Menjalankan shellcode...\n");

    // Eksekusi shellcode
    void (*func)() = (void (*)())shellcode;
    func();

    return 0;
}
